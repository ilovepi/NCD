<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Network Compression Detection: include/ncd.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Compression Detection
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ncd.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;netinet/ip.h&gt;</code><br/>
<code>#include &lt;netinet/ip6.h&gt;</code><br/>
<code>#include &lt;netinet/ip_icmp.h&gt;</code><br/>
<code>#include &lt;netinet/icmp6.h&gt;</code><br/>
<code>#include &lt;netinet/tcp.h&gt;</code><br/>
<code>#include &lt;netinet/udp.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
</div>
<p><a href="../../dc/d68/ncd_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a70ed59adcb4159ac551058053e649640"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a70ed59adcb4159ac551058053e649640">SIZE</a>&#160;&#160;&#160;(1500 - sizeof(struct ip))</td></tr>
<tr class="memdesc:a70ed59adcb4159ac551058053e649640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Favor the BSD style UDP &amp; IP headers.  <a href="#a70ed59adcb4159ac551058053e649640">More...</a><br/></td></tr>
<tr class="separator:a70ed59adcb4159ac551058053e649640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e039e4bc205e04f774f09e68e63868f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a8e039e4bc205e04f774f09e68e63868f">UDP_DATA_SIZE</a>&#160;&#160;&#160;(<a class="el" href="../../dc/d68/ncd_8h.html#a70ed59adcb4159ac551058053e649640">SIZE</a>-sizeof(struct udphdr)-sizeof(u_int16_t))</td></tr>
<tr class="separator:a8e039e4bc205e04f774f09e68e63868f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdac791ecf1a42be6a814a0c23aa795b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#afdac791ecf1a42be6a814a0c23aa795b">TCP_DATA_SIZE</a>&#160;&#160;&#160;(<a class="el" href="../../dc/d68/ncd_8h.html#a70ed59adcb4159ac551058053e649640">SIZE</a>-sizeof(struct tcphdr)-sizeof(u_int16_t))</td></tr>
<tr class="separator:afdac791ecf1a42be6a814a0c23aa795b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ad006b97556561b12d11cc3aee188a3"><td class="memItemLeft" align="right" valign="top">struct&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a4ad006b97556561b12d11cc3aee188a3">__attribute__</a> ((__packed__)) pseudo_header</td></tr>
<tr class="memdesc:a4ad006b97556561b12d11cc3aee188a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct for udp pseudo header  <a href="#a4ad006b97556561b12d11cc3aee188a3">More...</a><br/></td></tr>
<tr class="separator:a4ad006b97556561b12d11cc3aee188a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6dece13c2b3ee7b9da91f18cf0dcf38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#ad6dece13c2b3ee7b9da91f18cf0dcf38">detect</a> ()</td></tr>
<tr class="memdesc:ad6dece13c2b3ee7b9da91f18cf0dcf38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if compression occurs along the current transmission path to host by sending data to a remote location.  <a href="#ad6dece13c2b3ee7b9da91f18cf0dcf38">More...</a><br/></td></tr>
<tr class="separator:ad6dece13c2b3ee7b9da91f18cf0dcf38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff59b200462e5067c5b990085a426663"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#aff59b200462e5067c5b990085a426663">measure</a> ()</td></tr>
<tr class="memdesc:aff59b200462e5067c5b990085a426663"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends and measures a single data train, setup and called from comp_det()  <a href="#aff59b200462e5067c5b990085a426663">More...</a><br/></td></tr>
<tr class="separator:aff59b200462e5067c5b990085a426663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee31358878b74a8bb839fffd32aa84b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#aee31358878b74a8bb839fffd32aa84b7">mkipv4</a> (void *buff, u_int16_t size, u_int8_t proto)</td></tr>
<tr class="memdesc:aee31358878b74a8bb839fffd32aa84b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats an ipv4 header beginning at buff of length size.  <a href="#aee31358878b74a8bb839fffd32aa84b7">More...</a><br/></td></tr>
<tr class="separator:aee31358878b74a8bb839fffd32aa84b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a66cc6454a6f5e1c9b64ba5b5978b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a0a66cc6454a6f5e1c9b64ba5b5978b44">mkicmpv4</a> (void *buff, size_t datalen)</td></tr>
<tr class="memdesc:a0a66cc6454a6f5e1c9b64ba5b5978b44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats an ICMP packet beginning at buff with a payload of length datalen.  <a href="#a0a66cc6454a6f5e1c9b64ba5b5978b44">More...</a><br/></td></tr>
<tr class="separator:a0a66cc6454a6f5e1c9b64ba5b5978b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115536db290a1c30ffbc2c07e0db5fbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a115536db290a1c30ffbc2c07e0db5fbf">fill_data</a> (void *buff, size_t size)</td></tr>
<tr class="memdesc:a115536db290a1c30ffbc2c07e0db5fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the data portion of a packet with size bytes data from a file (char* file)  <a href="#a115536db290a1c30ffbc2c07e0db5fbf">More...</a><br/></td></tr>
<tr class="separator:a115536db290a1c30ffbc2c07e0db5fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36813875fd04fd1b400b09ad022b1024"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a36813875fd04fd1b400b09ad022b1024">send_udp</a> ()</td></tr>
<tr class="memdesc:a36813875fd04fd1b400b09ad022b1024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the UDP data train with leading and trailing ICMP messages.  <a href="#a36813875fd04fd1b400b09ad022b1024">More...</a><br/></td></tr>
<tr class="separator:a36813875fd04fd1b400b09ad022b1024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe8c28d14ff1bdee4102ca5d03b3e08"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#abbe8c28d14ff1bdee4102ca5d03b3e08">send_tcp</a> ()</td></tr>
<tr class="memdesc:abbe8c28d14ff1bdee4102ca5d03b3e08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a tcp data train with leading and trailing ICMP messages.  <a href="#abbe8c28d14ff1bdee4102ca5d03b3e08">More...</a><br/></td></tr>
<tr class="separator:abbe8c28d14ff1bdee4102ca5d03b3e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa584eddd915ff9cc908280b49b5cc60"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#aaa584eddd915ff9cc908280b49b5cc60">recv4</a> (void *t)</td></tr>
<tr class="memdesc:aaa584eddd915ff9cc908280b49b5cc60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives ICMP responses from end host and records times.  <a href="#aaa584eddd915ff9cc908280b49b5cc60">More...</a><br/></td></tr>
<tr class="separator:aaa584eddd915ff9cc908280b49b5cc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b2931d45a3e921538a04b9dc56afcf"><td class="memItemLeft" align="right" valign="top">u_int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#ad9b2931d45a3e921538a04b9dc56afcf">ip_checksum</a> (void *vdata, size_t length)</td></tr>
<tr class="memdesc:ad9b2931d45a3e921538a04b9dc56afcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the ip cheksum for some buffer of size length.  <a href="#ad9b2931d45a3e921538a04b9dc56afcf">More...</a><br/></td></tr>
<tr class="separator:ad9b2931d45a3e921538a04b9dc56afcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ffa5784a46ec2b471bf3ba8c1aa870"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a91ffa5784a46ec2b471bf3ba8c1aa870">check_args</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a91ffa5784a46ec2b471bf3ba8c1aa870"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks arguments given on command line and stores values in global variables.  <a href="#a91ffa5784a46ec2b471bf3ba8c1aa870">More...</a><br/></td></tr>
<tr class="separator:a91ffa5784a46ec2b471bf3ba8c1aa870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce97d161cdf0a5c7fe5900400b08897"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a9ce97d161cdf0a5c7fe5900400b08897">setup_tcp_train</a> (char **buff, int fill)</td></tr>
<tr class="memdesc:a9ce97d161cdf0a5c7fe5900400b08897"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets up an array of TCP packets located at buff.  <a href="#a9ce97d161cdf0a5c7fe5900400b08897">More...</a><br/></td></tr>
<tr class="separator:a9ce97d161cdf0a5c7fe5900400b08897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d03bf539922f9b644641a45bd7c836"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#a95d03bf539922f9b644641a45bd7c836">setup_tcp_packets</a> ()</td></tr>
<tr class="memdesc:a95d03bf539922f9b644641a45bd7c836"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets up arrays of TCP packets.  <a href="#a95d03bf539922f9b644641a45bd7c836">More...</a><br/></td></tr>
<tr class="separator:a95d03bf539922f9b644641a45bd7c836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab7dc6afbfb13289365b893e1d4c741"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#afab7dc6afbfb13289365b893e1d4c741">setup_syn_packets</a> ()</td></tr>
<tr class="memdesc:afab7dc6afbfb13289365b893e1d4c741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up syn packets for use in tcp_send.  <a href="#afab7dc6afbfb13289365b893e1d4c741">More...</a><br/></td></tr>
<tr class="separator:afab7dc6afbfb13289365b893e1d4c741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab684191a099670d8f4f3f4c7ac61c15b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/ncd_8h.html#ab684191a099670d8f4f3f4c7ac61c15b">setup_syn_packet</a> (void *buff, u_int16_t port)</td></tr>
<tr class="memdesc:ab684191a099670d8f4f3f4c7ac61c15b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up a single syn packet for use in tcp_send.  <a href="#ab684191a099670d8f4f3f4c7ac61c15b">More...</a><br/></td></tr>
<tr class="separator:ab684191a099670d8f4f3f4c7ac61c15b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a70ed59adcb4159ac551058053e649640"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SIZE&#160;&#160;&#160;(1500 - sizeof(struct ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Favor the BSD style UDP &amp; IP headers. </p>
<p>maximum ip packet size 1500 bytes Ethernet max size 40 IPv6 header max size 8 UDP header 2 16-bit packet ID </p>

<p>Definition at line <a class="el" href="../../dc/d68/ncd_8h_source.html#l00043">43</a> of file <a class="el" href="../../dc/d68/ncd_8h_source.html">ncd.h</a>.</p>

</div>
</div>
<a class="anchor" id="afdac791ecf1a42be6a814a0c23aa795b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_DATA_SIZE&#160;&#160;&#160;(<a class="el" href="../../dc/d68/ncd_8h.html#a70ed59adcb4159ac551058053e649640">SIZE</a>-sizeof(struct tcphdr)-sizeof(u_int16_t))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/d68/ncd_8h_source.html#l00045">45</a> of file <a class="el" href="../../dc/d68/ncd_8h_source.html">ncd.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8e039e4bc205e04f774f09e68e63868f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UDP_DATA_SIZE&#160;&#160;&#160;(<a class="el" href="../../dc/d68/ncd_8h.html#a70ed59adcb4159ac551058053e649640">SIZE</a>-sizeof(struct udphdr)-sizeof(u_int16_t))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/d68/ncd_8h_source.html#l00044">44</a> of file <a class="el" href="../../dc/d68/ncd_8h_source.html">ncd.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4ad006b97556561b12d11cc3aee188a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(__packed__)&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>struct for udp pseudo header </p>

<p>Definition at line <a class="el" href="../../dc/d68/ncd_8h_source.html#l00050">50</a> of file <a class="el" href="../../dc/d68/ncd_8h_source.html">ncd.h</a>.</p>

</div>
</div>
<a class="anchor" id="a91ffa5784a46ec2b471bf3ba8c1aa870"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_args </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks arguments given on command line and stores values in global variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>number of command line args </td></tr>
    <tr><td class="paramname">argv</td><td>array of commandline args </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00907">907</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad6dece13c2b3ee7b9da91f18cf0dcf38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int detect </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if compression occurs along the current transmission path to host by sending data to a remote location. </p>
<p>Determines if compression occurs along the current transmission path to host by sending data to a remote location. Two data trains are sent each with leading and trailing ICMP timestamp messages The first data train will be low entropy data, to encourage compression the second train will have high entropy data, which should not be compressed if the times are significantly different, we have reasonable evidence compression exists along this path.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00243">243</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="a115536db290a1c30ffbc2c07e0db5fbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fill_data </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the data portion of a packet with size bytes data from a file (char* file) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">buff</td><td>Address of the starting location for the data to be filled </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The length of the data region to be filled </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00689">689</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad9b2931d45a3e921538a04b9dc56afcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_int16_t ip_checksum </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the ip cheksum for some buffer of size length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vdata</td><td>a pointer to the buffer to be checksummed </td></tr>
    <tr><td class="paramname">length</td><td>the length in bytes of the data to be checksummed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the IP checksum of the buffer </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00846">846</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="aff59b200462e5067c5b990085a426663"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends and measures a single data train, setup and called from comp_det() </p>
<p>Sends and measures a single data train, setup and called from comp_det(). It does most of the work in NCD, by sending a single data train and taking all relevant measurements. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00303">303</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0a66cc6454a6f5e1c9b64ba5b5978b44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mkicmpv4 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formats an ICMP packet beginning at buff with a payload of length datalen. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buff</td><td>Address of the starting location for the ICMP packet </td></tr>
    <tr><td class="paramname">datalen</td><td>The length of the ICMP payload </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00545">545</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="aee31358878b74a8bb839fffd32aa84b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mkipv4 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>proto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formats an ipv4 header beginning at buff of length size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buff</td><td>Address of the starting location for the IP packet </td></tr>
    <tr><td class="paramname">size</td><td>The length of the IP packet </td></tr>
    <tr><td class="paramname">proto</td><td>The 8-bit protocol </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00409">409</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaa584eddd915ff9cc908280b49b5cc60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* recv4 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives ICMP responses from end host and records times. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">t</td><td>Pointer to a double. Returns the time in ms between head echo response and first processed tail echo response to a resolution of microseconds (10^-6 sec) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) &ndash; pthreads </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00706">706</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="abbe8c28d14ff1bdee4102ca5d03b3e08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* send_tcp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a tcp data train with leading and trailing ICMP messages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">status</td><td>returns the status/return code </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00618">618</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="a36813875fd04fd1b400b09ad022b1024"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* send_udp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the UDP data train with leading and trailing ICMP messages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">status</td><td>returns the status/return code </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00567">567</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab684191a099670d8f4f3f4c7ac61c15b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_syn_packet </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up a single syn packet for use in tcp_send. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buff</td><td>address of tcp header start for syn packet </td></tr>
    <tr><td class="paramname">port</td><td>the source port the syn packet should use. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00432">432</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="afab7dc6afbfb13289365b893e1d4c741"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_syn_packets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up syn packets for use in tcp_send. </p>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00461">461</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="a95d03bf539922f9b644641a45bd7c836"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_tcp_packets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets up arrays of TCP packets. </p>
<p>Can be extended to UDP if necessary </p>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00530">530</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9ce97d161cdf0a5c7fe5900400b08897"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_tcp_train </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets up an array of TCP packets located at buff. </p>
<p>Can be extended to UDP if necessary </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buff</td><td>the starting location of the packet train </td></tr>
    <tr><td class="paramname">fill</td><td>a boolean value to fill the packets from file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer value for success(0), failure(1), or error(-1) </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfe/ncd_8c_source.html#l00467">467</a> of file <a class="el" href="../../df/dfe/ncd_8c_source.html">ncd.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 22 2015 20:25:39 for Network Compression Detection by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
