\hypertarget{ncd_8h}{\section{ncd.\-h File Reference}
\label{ncd_8h}\index{ncd.\-h@{ncd.\-h}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$time.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$netinet/ip.\-h$>$}\\*
{\ttfamily \#include $<$netinet/ip\-\_\-icmp.\-h$>$}\\*
{\ttfamily \#include $<$netinet/udp.\-h$>$}\\*
{\ttfamily \#include $<$netdb.\-h$>$}\\*
{\ttfamily \#include $<$signal.\-h$>$}\\*
{\ttfamily \#include $<$fcntl.\-h$>$}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structpseudo__header}{pseudo\-\_\-header}
\begin{DoxyCompactList}\small\item\em struct for udp pseudo header \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ncd_8h_a70ed59adcb4159ac551058053e649640}{S\-I\-Z\-E}~1500
\begin{DoxyCompactList}\small\item\em maximum ip packet size \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ncd_8h_aa5d407939440fe5743c9e978debe7322}{comp\-\_\-det} (char $\ast$address, char $\ast$port, char hl, size\-\_\-t data\-\_\-size, size\-\_\-t num\-\_\-packets, ushort ttl, size\-\_\-t time\-\_\-wait, int n\-\_\-tail)
\begin{DoxyCompactList}\small\item\em Determines if compression occurs along the current transmission path to host by sending data to a remote location. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_ac8152c8966a6141057e9b24d239a9f23}{send\-\_\-data} (char $\ast$address, char $\ast$port, char hl, size\-\_\-t data\-\_\-size, size\-\_\-t num\-\_\-packets, ushort ttl, size\-\_\-t time\-\_\-wait, int n\-\_\-tail)
\begin{DoxyCompactList}\small\item\em sends data train to the end host with leading and trailing icmp timestamps \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_a39544cf1c63682d17e9c1d9215f42842}{recv\-\_\-data} (double $\ast$time)
\begin{DoxyCompactList}\small\item\em Receives I\-C\-M\-P responses from end host and records times. \end{DoxyCompactList}\item 
uint16\-\_\-t \hyperlink{ncd_8h_a6e25195727f4483c9e7224de02cb55be}{ip\-\_\-checksum} (void $\ast$vdata, size\-\_\-t length)
\begin{DoxyCompactList}\small\item\em calculates the ip cheksum for some buffer of size length \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{ncd_8h_a70ed59adcb4159ac551058053e649640}{\index{ncd.\-h@{ncd.\-h}!S\-I\-Z\-E@{S\-I\-Z\-E}}
\index{S\-I\-Z\-E@{S\-I\-Z\-E}!ncd.h@{ncd.\-h}}
\subsubsection[{S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-I\-Z\-E~1500}}\label{ncd_8h_a70ed59adcb4159ac551058053e649640}


maximum ip packet size 



Definition at line 21 of file ncd.\-h.



\subsection{Function Documentation}
\hypertarget{ncd_8h_aa5d407939440fe5743c9e978debe7322}{\index{ncd.\-h@{ncd.\-h}!comp\-\_\-det@{comp\-\_\-det}}
\index{comp\-\_\-det@{comp\-\_\-det}!ncd.h@{ncd.\-h}}
\subsubsection[{comp\-\_\-det}]{\setlength{\rightskip}{0pt plus 5cm}int comp\-\_\-det (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{address, }
\item[{char $\ast$}]{port, }
\item[{char}]{hl, }
\item[{size\-\_\-t}]{data\-\_\-size, }
\item[{size\-\_\-t}]{num\-\_\-packets, }
\item[{ushort}]{ttl, }
\item[{size\-\_\-t}]{time\-\_\-wait, }
\item[{int}]{n\-\_\-tail}
\end{DoxyParamCaption}
)}}\label{ncd_8h_aa5d407939440fe5743c9e978debe7322}


Determines if compression occurs along the current transmission path to host by sending data to a remote location. 

two data trains are sent each with leading and trailing I\-C\-M\-P timestamp messages

the first data train will be low entropy data, to encourage compression the second train will have high entropy data, which should not be compressed if the times are significantly different, we have reasonable evidence compression exists along this path.


\begin{DoxyParams}{Parameters}
{\em address} & the address of the end host stored in a char array (cstring) \\
\hline
{\em port} & the port number or service name \\
\hline
{\em num\-\_\-packets} & the number of packets in each data train \\
\hline
{\em time\-\_\-wait} & the wait between trains \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 success, 1 error/failure 
\end{DoxyReturn}


Definition at line 19 of file ncd.\-c.

\hypertarget{ncd_8h_a6e25195727f4483c9e7224de02cb55be}{\index{ncd.\-h@{ncd.\-h}!ip\-\_\-checksum@{ip\-\_\-checksum}}
\index{ip\-\_\-checksum@{ip\-\_\-checksum}!ncd.h@{ncd.\-h}}
\subsubsection[{ip\-\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}uint16\-\_\-t ip\-\_\-checksum (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{vdata, }
\item[{size\-\_\-t}]{length}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a6e25195727f4483c9e7224de02cb55be}


calculates the ip cheksum for some buffer of size length 


\begin{DoxyParams}{Parameters}
{\em vdata} & a pointer to the buffer to be checksummed \\
\hline
{\em length} & the length in bytes of the data to be checksummed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the I\-P checksum of the buffer 
\end{DoxyReturn}


Definition at line 333 of file ncd.\-c.

\hypertarget{ncd_8h_a39544cf1c63682d17e9c1d9215f42842}{\index{ncd.\-h@{ncd.\-h}!recv\-\_\-data@{recv\-\_\-data}}
\index{recv\-\_\-data@{recv\-\_\-data}!ncd.h@{ncd.\-h}}
\subsubsection[{recv\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int recv\-\_\-data (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{time}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a39544cf1c63682d17e9c1d9215f42842}


Receives I\-C\-M\-P responses from end host and records times. 


\begin{DoxyParams}{Parameters}
{\em time} & returns the time in ms between head echo response and first processed tail echo response to a resolution of microseconds (10$^\wedge$-\/6 sec) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 success, 1 error/failure 
\end{DoxyReturn}


Definition at line 254 of file ncd.\-c.

\hypertarget{ncd_8h_ac8152c8966a6141057e9b24d239a9f23}{\index{ncd.\-h@{ncd.\-h}!send\-\_\-data@{send\-\_\-data}}
\index{send\-\_\-data@{send\-\_\-data}!ncd.h@{ncd.\-h}}
\subsubsection[{send\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}int send\-\_\-data (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{address, }
\item[{char $\ast$}]{port, }
\item[{char}]{hl, }
\item[{size\-\_\-t}]{data\-\_\-size, }
\item[{size\-\_\-t}]{num\-\_\-packets, }
\item[{ushort}]{ttl, }
\item[{size\-\_\-t}]{time\-\_\-wait, }
\item[{int}]{n\-\_\-tail}
\end{DoxyParamCaption}
)}}\label{ncd_8h_ac8152c8966a6141057e9b24d239a9f23}


sends data train to the end host with leading and trailing icmp timestamps 

sets up a connection using raw sockets and sends a head I\-C\-M\-P echo request followed by a U\-D\-P data train. After the data train is sent, a series of I\-C\-M\-P echo responses is sent.


\begin{DoxyParams}{Parameters}
{\em address} & the address of the end host stored in a char array (cstring) \\
\hline
{\em port} & the port number or service name \\
\hline
{\em hl} & the entropy of the data (either 'H' for high entropy or 'L' for low entropy \\
\hline
{\em data\-\_\-size} & the size in bytes of the data to be sent in the udp train \\
\hline
{\em num\-\_\-packets} & the number of packets in each data train \\
\hline
{\em ttl} & the time to live for each packet (max size 255) \\
\hline
{\em time\-\_\-wait} & the wait between I\-C\-M\-P tail messages \\
\hline
{\em n\-\_\-tail} & the number of I\-C\-M\-P tail messages to be sent \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 success, 1 error/failure 
\end{DoxyReturn}


Definition at line 54 of file ncd.\-c.

