\hypertarget{ncd_8h}{\section{include/ncd.h File Reference}
\label{ncd_8h}\index{include/ncd.\-h@{include/ncd.\-h}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$netinet/ip.\-h$>$}\\*
{\ttfamily \#include $<$netinet/ip\-\_\-icmp.\-h$>$}\\*
{\ttfamily \#include $<$netinet/tcp.\-h$>$}\\*
{\ttfamily \#include $<$netinet/udp.\-h$>$}\\*
{\ttfamily \#include $<$netdb.\-h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\-h$>$}\\*
{\ttfamily \#include $<$signal.\-h$>$}\\*
{\ttfamily \#include $<$fcntl.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$ctype.\-h$>$}\\*
{\ttfamily \#include $<$pthread.\-h$>$}\\*
{\ttfamily \#include \char`\"{}ncd\-\_\-global.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{ncd_8h_a634b2de1d27b4fd5b22f6fc46b805d9b}{get\-\_\-time} (void)
\begin{DoxyCompactList}\small\item\em Favor the B\-S\-D style U\-D\-P \& I\-P headers. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection} ()
\begin{DoxyCompactList}\small\item\em \hyperlink{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection()}\-: initializes global variables for use in detection. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_ad6dece13c2b3ee7b9da91f18cf0dcf38}{detect} ()
\begin{DoxyCompactList}\small\item\em Determines if compression occurs along the current transmission path to host by sending data to a remote location. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_aff59b200462e5067c5b990085a426663}{measure} ()
\begin{DoxyCompactList}\small\item\em Sends and measures a single data train, setup and called from comp\-\_\-det() \end{DoxyCompactList}\item 
void \hyperlink{ncd_8h_aee31358878b74a8bb839fffd32aa84b7}{mkipv4} (void $\ast$buff, u\-\_\-int16\-\_\-t size, u\-\_\-int8\-\_\-t proto)
\begin{DoxyCompactList}\small\item\em Formats an ipv4 header beginning at buff of length size. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8h_a0a66cc6454a6f5e1c9b64ba5b5978b44}{mkicmpv4} (void $\ast$buff, size\-\_\-t datalen)
\begin{DoxyCompactList}\small\item\em Formats an I\-C\-M\-P packet beginning at buff with a payload of length datalen. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8h_a115536db290a1c30ffbc2c07e0db5fbf}{fill\-\_\-data} (void $\ast$buff, size\-\_\-t size)
\begin{DoxyCompactList}\small\item\em Fills the data portion of a packet with size bytes data from a file (char$\ast$ file) \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8h_a0c8bb5479a27edccf644f75c36f88a03}{send\-\_\-udp} (void $\ast$status)
\begin{DoxyCompactList}\small\item\em Sends the U\-D\-P data train with leading and trailing I\-C\-M\-P messages. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8h_afd55a5cd2ac890d1ea9b629322c8ed92}{send\-\_\-tcp} (void $\ast$status)
\begin{DoxyCompactList}\small\item\em Sends a tcp data train with leading and trailing I\-C\-M\-P messages. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8h_aaa584eddd915ff9cc908280b49b5cc60}{recv4} (void $\ast$t)
\begin{DoxyCompactList}\small\item\em Receives I\-C\-M\-P responses from end host and records times. \end{DoxyCompactList}\item 
u\-\_\-int16\-\_\-t \hyperlink{ncd_8h_ad9b2931d45a3e921538a04b9dc56afcf}{ip\-\_\-checksum} (void $\ast$vdata, size\-\_\-t length)
\begin{DoxyCompactList}\small\item\em Calculates the ip cheksum for some buffer of size length. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_a91ffa5784a46ec2b471bf3ba8c1aa870}{check\-\_\-args} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Checks arguments given on command line and stores values in global variables. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_a9ce97d161cdf0a5c7fe5900400b08897}{setup\-\_\-tcp\-\_\-train} (char $\ast$$\ast$buff, int fill)
\begin{DoxyCompactList}\small\item\em sets up an array of T\-C\-P packets located at buff. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8h_a95d03bf539922f9b644641a45bd7c836}{setup\-\_\-tcp\-\_\-packets} ()
\begin{DoxyCompactList}\small\item\em sets up arrays of T\-C\-P packets. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8h_afab7dc6afbfb13289365b893e1d4c741}{setup\-\_\-syn\-\_\-packets} ()
\begin{DoxyCompactList}\small\item\em Sets up syn packets for use in tcp\-\_\-send. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8h_ab684191a099670d8f4f3f4c7ac61c15b}{setup\-\_\-syn\-\_\-packet} (void $\ast$buff, u\-\_\-int16\-\_\-t port)
\begin{DoxyCompactList}\small\item\em Sets up a single syn packet for use in tcp\-\_\-send. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{ncd_8h_a91ffa5784a46ec2b471bf3ba8c1aa870}{\index{ncd.\-h@{ncd.\-h}!check\-\_\-args@{check\-\_\-args}}
\index{check\-\_\-args@{check\-\_\-args}!ncd.h@{ncd.\-h}}
\subsubsection[{check\-\_\-args}]{\setlength{\rightskip}{0pt plus 5cm}int check\-\_\-args (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a91ffa5784a46ec2b471bf3ba8c1aa870}


Checks arguments given on command line and stores values in global variables. 


\begin{DoxyParams}{Parameters}
{\em argc} & number of command line args \\
\hline
{\em argv} & array of commandline args \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 941 of file ncd.\-c.

\hypertarget{ncd_8h_ad6dece13c2b3ee7b9da91f18cf0dcf38}{\index{ncd.\-h@{ncd.\-h}!detect@{detect}}
\index{detect@{detect}!ncd.h@{ncd.\-h}}
\subsubsection[{detect}]{\setlength{\rightskip}{0pt plus 5cm}int detect (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_ad6dece13c2b3ee7b9da91f18cf0dcf38}


Determines if compression occurs along the current transmission path to host by sending data to a remote location. 

Determines if compression occurs along the current transmission path to host by sending data to a remote location. Two data trains are sent each with leading and trailing I\-C\-M\-P timestamp messages The first data train will be low entropy data, to encourage compression the second train will have high entropy data, which should not be compressed if the times are significantly different, we have reasonable evidence compression exists along this path.

\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 218 of file ncd.\-c.

\hypertarget{ncd_8h_a115536db290a1c30ffbc2c07e0db5fbf}{\index{ncd.\-h@{ncd.\-h}!fill\-\_\-data@{fill\-\_\-data}}
\index{fill\-\_\-data@{fill\-\_\-data}!ncd.h@{ncd.\-h}}
\subsubsection[{fill\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}void fill\-\_\-data (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a115536db290a1c30ffbc2c07e0db5fbf}


Fills the data portion of a packet with size bytes data from a file (char$\ast$ file) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em buff} & Address of the starting location for the data to be filled \\
\hline
\mbox{\tt in}  & {\em size} & The length of the data region to be filled \\
\hline
\end{DoxyParams}


Definition at line 703 of file ncd.\-c.

\hypertarget{ncd_8h_a634b2de1d27b4fd5b22f6fc46b805d9b}{\index{ncd.\-h@{ncd.\-h}!get\-\_\-time@{get\-\_\-time}}
\index{get\-\_\-time@{get\-\_\-time}!ncd.h@{ncd.\-h}}
\subsubsection[{get\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}double get\-\_\-time (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a634b2de1d27b4fd5b22f6fc46b805d9b}


Favor the B\-S\-D style U\-D\-P \& I\-P headers. 

@ brief Returns current time as double, with most possible precision \begin{DoxyReturn}{Returns}
Returns current time as double, with most possible precision. 
\end{DoxyReturn}


Definition at line 41 of file ncd.\-c.

\hypertarget{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{\index{ncd.\-h@{ncd.\-h}!init\-\_\-detection@{init\-\_\-detection}}
\index{init\-\_\-detection@{init\-\_\-detection}!ncd.h@{ncd.\-h}}
\subsubsection[{init\-\_\-detection}]{\setlength{\rightskip}{0pt plus 5cm}int init\-\_\-detection (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a09e5952022b76cf427821fee2c4060d4}


\hyperlink{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection()}\-: initializes global variables for use in detection. 

\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 50 of file ncd.\-c.

\hypertarget{ncd_8h_ad9b2931d45a3e921538a04b9dc56afcf}{\index{ncd.\-h@{ncd.\-h}!ip\-\_\-checksum@{ip\-\_\-checksum}}
\index{ip\-\_\-checksum@{ip\-\_\-checksum}!ncd.h@{ncd.\-h}}
\subsubsection[{ip\-\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int16\-\_\-t ip\-\_\-checksum (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{vdata, }
\item[{size\-\_\-t}]{length}
\end{DoxyParamCaption}
)}}\label{ncd_8h_ad9b2931d45a3e921538a04b9dc56afcf}


Calculates the ip cheksum for some buffer of size length. 


\begin{DoxyParams}{Parameters}
{\em vdata} & a pointer to the buffer to be checksummed \\
\hline
{\em length} & the length in bytes of the data to be checksummed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the I\-P checksum of the buffer 
\end{DoxyReturn}


Definition at line 874 of file ncd.\-c.

\hypertarget{ncd_8h_aff59b200462e5067c5b990085a426663}{\index{ncd.\-h@{ncd.\-h}!measure@{measure}}
\index{measure@{measure}!ncd.h@{ncd.\-h}}
\subsubsection[{measure}]{\setlength{\rightskip}{0pt plus 5cm}int measure (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_aff59b200462e5067c5b990085a426663}


Sends and measures a single data train, setup and called from comp\-\_\-det() 

Sends and measures a single data train, setup and called from comp\-\_\-det(). It does most of the work in N\-C\-D, by sending a single data train and taking all relevant measurements. \begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 288 of file ncd.\-c.

\hypertarget{ncd_8h_a0a66cc6454a6f5e1c9b64ba5b5978b44}{\index{ncd.\-h@{ncd.\-h}!mkicmpv4@{mkicmpv4}}
\index{mkicmpv4@{mkicmpv4}!ncd.h@{ncd.\-h}}
\subsubsection[{mkicmpv4}]{\setlength{\rightskip}{0pt plus 5cm}void mkicmpv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{size\-\_\-t}]{datalen}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a0a66cc6454a6f5e1c9b64ba5b5978b44}


Formats an I\-C\-M\-P packet beginning at buff with a payload of length datalen. 


\begin{DoxyParams}{Parameters}
{\em buff} & Address of the starting location for the I\-C\-M\-P packet \\
\hline
{\em datalen} & The length of the I\-C\-M\-P payload \\
\hline
\end{DoxyParams}


Definition at line 541 of file ncd.\-c.

\hypertarget{ncd_8h_aee31358878b74a8bb839fffd32aa84b7}{\index{ncd.\-h@{ncd.\-h}!mkipv4@{mkipv4}}
\index{mkipv4@{mkipv4}!ncd.h@{ncd.\-h}}
\subsubsection[{mkipv4}]{\setlength{\rightskip}{0pt plus 5cm}void mkipv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{u\-\_\-int16\-\_\-t}]{size, }
\item[{u\-\_\-int8\-\_\-t}]{proto}
\end{DoxyParamCaption}
)}}\label{ncd_8h_aee31358878b74a8bb839fffd32aa84b7}


Formats an ipv4 header beginning at buff of length size. 


\begin{DoxyParams}{Parameters}
{\em buff} & Address of the starting location for the I\-P packet \\
\hline
{\em size} & The length of the I\-P packet \\
\hline
{\em proto} & The 8-\/bit protocol \\
\hline
\end{DoxyParams}


Definition at line 404 of file ncd.\-c.

\hypertarget{ncd_8h_aaa584eddd915ff9cc908280b49b5cc60}{\index{ncd.\-h@{ncd.\-h}!recv4@{recv4}}
\index{recv4@{recv4}!ncd.h@{ncd.\-h}}
\subsubsection[{recv4}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ recv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{ncd_8h_aaa584eddd915ff9cc908280b49b5cc60}


Receives I\-C\-M\-P responses from end host and records times. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em t} & Pointer to a double. Returns the time in ms between head echo response and first processed tail echo response to a resolution of microseconds (10$^\wedge$-\/6 sec) $\ast$ \\
\hline
\end{DoxyParams}


Definition at line 722 of file ncd.\-c.

\hypertarget{ncd_8h_afd55a5cd2ac890d1ea9b629322c8ed92}{\index{ncd.\-h@{ncd.\-h}!send\-\_\-tcp@{send\-\_\-tcp}}
\index{send\-\_\-tcp@{send\-\_\-tcp}!ncd.h@{ncd.\-h}}
\subsubsection[{send\-\_\-tcp}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ send\-\_\-tcp (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{status}
\end{DoxyParamCaption}
)}}\label{ncd_8h_afd55a5cd2ac890d1ea9b629322c8ed92}


Sends a tcp data train with leading and trailing I\-C\-M\-P messages. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em status} & returns the status/return code \\
\hline
\end{DoxyParams}


Definition at line 626 of file ncd.\-c.

\hypertarget{ncd_8h_a0c8bb5479a27edccf644f75c36f88a03}{\index{ncd.\-h@{ncd.\-h}!send\-\_\-udp@{send\-\_\-udp}}
\index{send\-\_\-udp@{send\-\_\-udp}!ncd.h@{ncd.\-h}}
\subsubsection[{send\-\_\-udp}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ send\-\_\-udp (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{status}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a0c8bb5479a27edccf644f75c36f88a03}


Sends the U\-D\-P data train with leading and trailing I\-C\-M\-P messages. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em status} & returns the status/return code \\
\hline
\end{DoxyParams}


Definition at line 569 of file ncd.\-c.

\hypertarget{ncd_8h_ab684191a099670d8f4f3f4c7ac61c15b}{\index{ncd.\-h@{ncd.\-h}!setup\-\_\-syn\-\_\-packet@{setup\-\_\-syn\-\_\-packet}}
\index{setup\-\_\-syn\-\_\-packet@{setup\-\_\-syn\-\_\-packet}!ncd.h@{ncd.\-h}}
\subsubsection[{setup\-\_\-syn\-\_\-packet}]{\setlength{\rightskip}{0pt plus 5cm}void setup\-\_\-syn\-\_\-packet (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{u\-\_\-int16\-\_\-t}]{port}
\end{DoxyParamCaption}
)}}\label{ncd_8h_ab684191a099670d8f4f3f4c7ac61c15b}


Sets up a single syn packet for use in tcp\-\_\-send. 


\begin{DoxyParams}{Parameters}
{\em buff} & address of tcp header start for syn packet \\
\hline
{\em port} & the source port the syn packet should use. \\
\hline
\end{DoxyParams}


Definition at line 426 of file ncd.\-c.

\hypertarget{ncd_8h_afab7dc6afbfb13289365b893e1d4c741}{\index{ncd.\-h@{ncd.\-h}!setup\-\_\-syn\-\_\-packets@{setup\-\_\-syn\-\_\-packets}}
\index{setup\-\_\-syn\-\_\-packets@{setup\-\_\-syn\-\_\-packets}!ncd.h@{ncd.\-h}}
\subsubsection[{setup\-\_\-syn\-\_\-packets}]{\setlength{\rightskip}{0pt plus 5cm}void setup\-\_\-syn\-\_\-packets (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_afab7dc6afbfb13289365b893e1d4c741}


Sets up syn packets for use in tcp\-\_\-send. 



Definition at line 455 of file ncd.\-c.

\hypertarget{ncd_8h_a95d03bf539922f9b644641a45bd7c836}{\index{ncd.\-h@{ncd.\-h}!setup\-\_\-tcp\-\_\-packets@{setup\-\_\-tcp\-\_\-packets}}
\index{setup\-\_\-tcp\-\_\-packets@{setup\-\_\-tcp\-\_\-packets}!ncd.h@{ncd.\-h}}
\subsubsection[{setup\-\_\-tcp\-\_\-packets}]{\setlength{\rightskip}{0pt plus 5cm}int setup\-\_\-tcp\-\_\-packets (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a95d03bf539922f9b644641a45bd7c836}


sets up arrays of T\-C\-P packets. 

Can be extended to U\-D\-P if necessary \begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 526 of file ncd.\-c.

\hypertarget{ncd_8h_a9ce97d161cdf0a5c7fe5900400b08897}{\index{ncd.\-h@{ncd.\-h}!setup\-\_\-tcp\-\_\-train@{setup\-\_\-tcp\-\_\-train}}
\index{setup\-\_\-tcp\-\_\-train@{setup\-\_\-tcp\-\_\-train}!ncd.h@{ncd.\-h}}
\subsubsection[{setup\-\_\-tcp\-\_\-train}]{\setlength{\rightskip}{0pt plus 5cm}int setup\-\_\-tcp\-\_\-train (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{buff, }
\item[{int}]{fill}
\end{DoxyParamCaption}
)}}\label{ncd_8h_a9ce97d161cdf0a5c7fe5900400b08897}


sets up an array of T\-C\-P packets located at buff. 

Can be extended to U\-D\-P if necessary 
\begin{DoxyParams}{Parameters}
{\em buff} & the starting location of the packet train \\
\hline
{\em fill} & a boolean value to fill the packets from file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 461 of file ncd.\-c.

