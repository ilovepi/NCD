\hypertarget{ncd_8c}{\section{src/ncd.c File Reference}
\label{ncd_8c}\index{src/ncd.\-c@{src/ncd.\-c}}
}
{\ttfamily \#include \char`\"{}ncd.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bitset.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{ncd_8c_a634b2de1d27b4fd5b22f6fc46b805d9b}{get\-\_\-time} (void)
\begin{DoxyCompactList}\small\item\em Favor the B\-S\-D style U\-D\-P \& I\-P headers. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8c_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection} ()
\begin{DoxyCompactList}\small\item\em \hyperlink{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection()}\-: initializes global variables for use in detection. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8c_ad6dece13c2b3ee7b9da91f18cf0dcf38}{detect} ()
\begin{DoxyCompactList}\small\item\em Determines if compression occurs along the current transmission path to host by sending data to a remote location. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8c_aff59b200462e5067c5b990085a426663}{measure} ()
\begin{DoxyCompactList}\small\item\em Sends and measures a single data train, setup and called from comp\-\_\-det() \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_aee31358878b74a8bb839fffd32aa84b7}{mkipv4} (void $\ast$buff, u\-\_\-int16\-\_\-t size, u\-\_\-int8\-\_\-t proto)
\begin{DoxyCompactList}\small\item\em Formats an ipv4 header beginning at buff of length size. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_ab684191a099670d8f4f3f4c7ac61c15b}{setup\-\_\-syn\-\_\-packet} (void $\ast$buff, u\-\_\-int16\-\_\-t port)
\begin{DoxyCompactList}\small\item\em Sets up a single syn packet for use in tcp\-\_\-send. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_afab7dc6afbfb13289365b893e1d4c741}{setup\-\_\-syn\-\_\-packets} ()
\begin{DoxyCompactList}\small\item\em Sets up syn packets for use in tcp\-\_\-send. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8c_a9ce97d161cdf0a5c7fe5900400b08897}{setup\-\_\-tcp\-\_\-train} (char $\ast$$\ast$buff, int fill)
\begin{DoxyCompactList}\small\item\em sets up an array of T\-C\-P packets located at buff. \end{DoxyCompactList}\item 
int \hyperlink{ncd_8c_a95d03bf539922f9b644641a45bd7c836}{setup\-\_\-tcp\-\_\-packets} ()
\begin{DoxyCompactList}\small\item\em sets up arrays of T\-C\-P packets. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_a0a66cc6454a6f5e1c9b64ba5b5978b44}{mkicmpv4} (void $\ast$buff, size\-\_\-t datalen)
\begin{DoxyCompactList}\small\item\em Formats an I\-C\-M\-P packet beginning at buff with a payload of length datalen. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8c_a0c8bb5479a27edccf644f75c36f88a03}{send\-\_\-udp} (void $\ast$status)
\begin{DoxyCompactList}\small\item\em Sends the U\-D\-P data train with leading and trailing I\-C\-M\-P messages. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8c_afd55a5cd2ac890d1ea9b629322c8ed92}{send\-\_\-tcp} (void $\ast$status)
\begin{DoxyCompactList}\small\item\em Sends a tcp data train with leading and trailing I\-C\-M\-P messages. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_a115536db290a1c30ffbc2c07e0db5fbf}{fill\-\_\-data} (void $\ast$buff, size\-\_\-t size)
\begin{DoxyCompactList}\small\item\em Fills the data portion of a packet with size bytes data from a file (char$\ast$ file) \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{ncd_8c_aaa584eddd915ff9cc908280b49b5cc60}{recv4} (void $\ast$t)
\begin{DoxyCompactList}\small\item\em Receives I\-C\-M\-P responses from end host and records times. \end{DoxyCompactList}\item 
u\-\_\-int16\-\_\-t \hyperlink{ncd_8c_ad9b2931d45a3e921538a04b9dc56afcf}{ip\-\_\-checksum} (void $\ast$vdata, size\-\_\-t length)
\begin{DoxyCompactList}\small\item\em Calculates the ip cheksum for some buffer of size length. \end{DoxyCompactList}\item 
void \hyperlink{ncd_8c_a6bb04c1388ab75a69d14f9858953463c}{print\-\_\-use} (char $\ast$program\-\_\-name)
\item 
int \hyperlink{ncd_8c_a91ffa5784a46ec2b471bf3ba8c1aa870}{check\-\_\-args} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Checks arguments given on command line and stores values in global variables. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char $\ast$ \hyperlink{ncd_8c_ae1231b405862fa498bb62b2d7ac40638}{packets\-\_\-e} = N\-U\-L\-L
\item 
char $\ast$ \hyperlink{ncd_8c_a992ffe562a51dd08098b04a399a932ff}{packets\-\_\-f} = N\-U\-L\-L
\item 
char $\ast$ \hyperlink{ncd_8c_aa600d86ba40a79af175750031d366976}{dst\-\_\-ip} = N\-U\-L\-L
\item 
char $\ast$ \hyperlink{ncd_8c_adf16cd437526a5c5e0e0af87745acbb8}{file} = N\-U\-L\-L
\item 
u\-\_\-int8\-\_\-t \hyperlink{ncd_8c_a0373c2ec9cc3ad13431fb273d8c3e1db}{lflag} = 1
\item 
u\-\_\-int8\-\_\-t \hyperlink{ncd_8c_a2d25ad4faac817d870daa9b3b680e31d}{hflag} = 1
\item 
int \hyperlink{ncd_8c_a0b2caeb4b6f130be43e5a2f0267dd453}{verbose} = 0
\item 
const int \hyperlink{ncd_8c_ac2d0ab5e69029d08b446d94e9400f3a7}{num\-\_\-threads} = 2
\item 
int \hyperlink{ncd_8c_af6120b55f42d5cb6044788bba68b9521}{cooldown} = 5
\item 
u\-\_\-int8\-\_\-t \hyperlink{ncd_8c_abba8573cb98a02424a3867f7c43eae3a}{tcp\-\_\-bool} = 0
\item 
int \hyperlink{ncd_8c_a69b40191667f8e98fe175046c8121df4}{second\-\_\-train} = 0
\item 
char \hyperlink{ncd_8c_ab47c0369a44e17ff814fca2f5a7803d1}{pseudo} \mbox{[}1500\mbox{]} = \{0\}
\item 
char \hyperlink{ncd_8c_a94439982e7fc188dc12311c47568f5f9}{packet\-\_\-rcv} \mbox{[}1500\mbox{]} = \{0\}
\item 
char \hyperlink{ncd_8c_a43587531405dea543232fa917b84de56}{packet\-\_\-send} \mbox{[}\hyperlink{ncd__global_8h_a70ed59adcb4159ac551058053e649640}{S\-I\-Z\-E}\mbox{]} = \{0\}
\item 
char \hyperlink{ncd_8c_a20ea96ed21d158a055c5821e81905c45}{syn\-\_\-packet\-\_\-1} \mbox{[}20\mbox{]} = \{0\}
\item 
char \hyperlink{ncd_8c_ab685d5eebdfc594a07d1fe0667f7b33c}{syn\-\_\-packet\-\_\-2} \mbox{[}20\mbox{]} = \{0\}
\item 
char \hyperlink{ncd_8c_a806e49f97606bb7dbd7046b2fe7f0f3a}{icmp\-\_\-send} \mbox{[}128\mbox{]} = \{0\}
\item 
struct pseudo\-\_\-header $\ast$ \hyperlink{ncd_8c_a3d02a4ce56562a5dd244b87d52d694d4}{ps} = (struct pseudo\-\_\-header$\ast$)\hyperlink{ncd__global_8h_ab47c0369a44e17ff814fca2f5a7803d1}{pseudo}
\item 
u\-\_\-int16\-\_\-t $\ast$ \hyperlink{ncd_8c_a2c35aa99e2fa1178b69dedba73b0080c}{packet\-\_\-id} = (u\-\_\-int16\-\_\-t$\ast$)\hyperlink{ncd__global_8h_a43587531405dea543232fa917b84de56}{packet\-\_\-send}
\item 
struct sockaddr\-\_\-in \hyperlink{ncd_8c_a48e92478efee9e56a26e4ce75cd47a6e}{srcaddrs} = \{0\}
\item 
struct in\-\_\-addr \hyperlink{ncd_8c_aa41cf2785d688ec1e35c38a45f66c3bf}{destip} = \{0\}
\item 
socklen\-\_\-t \hyperlink{ncd_8c_a7f3b94a4048f6fd566062cb98a2e4143}{sa\-\_\-len} = sizeof(\hyperlink{ncd__global_8h_a48e92478efee9e56a26e4ce75cd47a6e}{srcaddrs})
\item 
struct addrinfo $\ast$ \hyperlink{ncd_8c_a8df42e4f21cb586ea4981025137520e0}{res} = N\-U\-L\-L
\item 
void $\ast$($\ast$ \hyperlink{ncd_8c_a6e7246feab9bd6f3f5da6f698465c62a}{recv\-\_\-data} )(void $\ast$) = N\-U\-L\-L
\item 
void $\ast$($\ast$ \hyperlink{ncd_8c_a915720bd1608e183b14479e206ecea46}{send\-\_\-train} )(void $\ast$) = N\-U\-L\-L
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyAuthor}{Author}
\-: Paul Kirth 
\end{DoxyAuthor}


Definition in file \hyperlink{ncd_8c_source}{ncd.\-c}.



\subsection{Function Documentation}
\hypertarget{ncd_8c_a91ffa5784a46ec2b471bf3ba8c1aa870}{\index{ncd.\-c@{ncd.\-c}!check\-\_\-args@{check\-\_\-args}}
\index{check\-\_\-args@{check\-\_\-args}!ncd.c@{ncd.\-c}}
\subsubsection[{check\-\_\-args}]{\setlength{\rightskip}{0pt plus 5cm}int check\-\_\-args (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a91ffa5784a46ec2b471bf3ba8c1aa870}


Checks arguments given on command line and stores values in global variables. 


\begin{DoxyParams}{Parameters}
{\em argc} & number of command line args \\
\hline
{\em argv} & array of commandline args \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 941 of file ncd.\-c.

\hypertarget{ncd_8c_ad6dece13c2b3ee7b9da91f18cf0dcf38}{\index{ncd.\-c@{ncd.\-c}!detect@{detect}}
\index{detect@{detect}!ncd.c@{ncd.\-c}}
\subsubsection[{detect}]{\setlength{\rightskip}{0pt plus 5cm}int detect (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_ad6dece13c2b3ee7b9da91f18cf0dcf38}


Determines if compression occurs along the current transmission path to host by sending data to a remote location. 

Determines if compression occurs along the current transmission path to host by sending data to a remote location. Two data trains are sent each with leading and trailing I\-C\-M\-P timestamp messages The first data train will be low entropy data, to encourage compression the second train will have high entropy data, which should not be compressed if the times are significantly different, we have reasonable evidence compression exists along this path.

\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 218 of file ncd.\-c.

\hypertarget{ncd_8c_a115536db290a1c30ffbc2c07e0db5fbf}{\index{ncd.\-c@{ncd.\-c}!fill\-\_\-data@{fill\-\_\-data}}
\index{fill\-\_\-data@{fill\-\_\-data}!ncd.c@{ncd.\-c}}
\subsubsection[{fill\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}void fill\-\_\-data (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a115536db290a1c30ffbc2c07e0db5fbf}


Fills the data portion of a packet with size bytes data from a file (char$\ast$ file) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em buff} & Address of the starting location for the data to be filled \\
\hline
\mbox{\tt in}  & {\em size} & The length of the data region to be filled \\
\hline
\end{DoxyParams}


Definition at line 703 of file ncd.\-c.

\hypertarget{ncd_8c_a634b2de1d27b4fd5b22f6fc46b805d9b}{\index{ncd.\-c@{ncd.\-c}!get\-\_\-time@{get\-\_\-time}}
\index{get\-\_\-time@{get\-\_\-time}!ncd.c@{ncd.\-c}}
\subsubsection[{get\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}double get\-\_\-time (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a634b2de1d27b4fd5b22f6fc46b805d9b}


Favor the B\-S\-D style U\-D\-P \& I\-P headers. 

@ brief Returns current time as double, with most possible precision \begin{DoxyReturn}{Returns}
Returns current time as double, with most possible precision. 
\end{DoxyReturn}


Definition at line 41 of file ncd.\-c.

\hypertarget{ncd_8c_a09e5952022b76cf427821fee2c4060d4}{\index{ncd.\-c@{ncd.\-c}!init\-\_\-detection@{init\-\_\-detection}}
\index{init\-\_\-detection@{init\-\_\-detection}!ncd.c@{ncd.\-c}}
\subsubsection[{init\-\_\-detection}]{\setlength{\rightskip}{0pt plus 5cm}int init\-\_\-detection (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a09e5952022b76cf427821fee2c4060d4}


\hyperlink{ncd_8h_a09e5952022b76cf427821fee2c4060d4}{init\-\_\-detection()}\-: initializes global variables for use in detection. 

\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 50 of file ncd.\-c.

\hypertarget{ncd_8c_ad9b2931d45a3e921538a04b9dc56afcf}{\index{ncd.\-c@{ncd.\-c}!ip\-\_\-checksum@{ip\-\_\-checksum}}
\index{ip\-\_\-checksum@{ip\-\_\-checksum}!ncd.c@{ncd.\-c}}
\subsubsection[{ip\-\_\-checksum}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int16\-\_\-t ip\-\_\-checksum (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{vdata, }
\item[{size\-\_\-t}]{length}
\end{DoxyParamCaption}
)}}\label{ncd_8c_ad9b2931d45a3e921538a04b9dc56afcf}


Calculates the ip cheksum for some buffer of size length. 


\begin{DoxyParams}{Parameters}
{\em vdata} & a pointer to the buffer to be checksummed \\
\hline
{\em length} & the length in bytes of the data to be checksummed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the I\-P checksum of the buffer 
\end{DoxyReturn}


Definition at line 874 of file ncd.\-c.

\hypertarget{ncd_8c_aff59b200462e5067c5b990085a426663}{\index{ncd.\-c@{ncd.\-c}!measure@{measure}}
\index{measure@{measure}!ncd.c@{ncd.\-c}}
\subsubsection[{measure}]{\setlength{\rightskip}{0pt plus 5cm}int measure (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_aff59b200462e5067c5b990085a426663}


Sends and measures a single data train, setup and called from comp\-\_\-det() 

Sends and measures a single data train, setup and called from comp\-\_\-det(). It does most of the work in N\-C\-D, by sending a single data train and taking all relevant measurements. \begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 288 of file ncd.\-c.

\hypertarget{ncd_8c_a0a66cc6454a6f5e1c9b64ba5b5978b44}{\index{ncd.\-c@{ncd.\-c}!mkicmpv4@{mkicmpv4}}
\index{mkicmpv4@{mkicmpv4}!ncd.c@{ncd.\-c}}
\subsubsection[{mkicmpv4}]{\setlength{\rightskip}{0pt plus 5cm}void mkicmpv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{size\-\_\-t}]{datalen}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a0a66cc6454a6f5e1c9b64ba5b5978b44}


Formats an I\-C\-M\-P packet beginning at buff with a payload of length datalen. 


\begin{DoxyParams}{Parameters}
{\em buff} & Address of the starting location for the I\-C\-M\-P packet \\
\hline
{\em datalen} & The length of the I\-C\-M\-P payload \\
\hline
\end{DoxyParams}


Definition at line 541 of file ncd.\-c.

\hypertarget{ncd_8c_aee31358878b74a8bb839fffd32aa84b7}{\index{ncd.\-c@{ncd.\-c}!mkipv4@{mkipv4}}
\index{mkipv4@{mkipv4}!ncd.c@{ncd.\-c}}
\subsubsection[{mkipv4}]{\setlength{\rightskip}{0pt plus 5cm}void mkipv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{u\-\_\-int16\-\_\-t}]{size, }
\item[{u\-\_\-int8\-\_\-t}]{proto}
\end{DoxyParamCaption}
)}}\label{ncd_8c_aee31358878b74a8bb839fffd32aa84b7}


Formats an ipv4 header beginning at buff of length size. 


\begin{DoxyParams}{Parameters}
{\em buff} & Address of the starting location for the I\-P packet \\
\hline
{\em size} & The length of the I\-P packet \\
\hline
{\em proto} & The 8-\/bit protocol \\
\hline
\end{DoxyParams}


Definition at line 404 of file ncd.\-c.

\hypertarget{ncd_8c_a6bb04c1388ab75a69d14f9858953463c}{\index{ncd.\-c@{ncd.\-c}!print\-\_\-use@{print\-\_\-use}}
\index{print\-\_\-use@{print\-\_\-use}!ncd.c@{ncd.\-c}}
\subsubsection[{print\-\_\-use}]{\setlength{\rightskip}{0pt plus 5cm}void print\-\_\-use (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{program\-\_\-name}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a6bb04c1388ab75a69d14f9858953463c}


Definition at line 933 of file ncd.\-c.

\hypertarget{ncd_8c_aaa584eddd915ff9cc908280b49b5cc60}{\index{ncd.\-c@{ncd.\-c}!recv4@{recv4}}
\index{recv4@{recv4}!ncd.c@{ncd.\-c}}
\subsubsection[{recv4}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ recv4 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{ncd_8c_aaa584eddd915ff9cc908280b49b5cc60}


Receives I\-C\-M\-P responses from end host and records times. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em t} & Pointer to a double. Returns the time in ms between head echo response and first processed tail echo response to a resolution of microseconds (10$^\wedge$-\/6 sec) $\ast$ \\
\hline
\end{DoxyParams}


Definition at line 722 of file ncd.\-c.

\hypertarget{ncd_8c_afd55a5cd2ac890d1ea9b629322c8ed92}{\index{ncd.\-c@{ncd.\-c}!send\-\_\-tcp@{send\-\_\-tcp}}
\index{send\-\_\-tcp@{send\-\_\-tcp}!ncd.c@{ncd.\-c}}
\subsubsection[{send\-\_\-tcp}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ send\-\_\-tcp (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{status}
\end{DoxyParamCaption}
)}}\label{ncd_8c_afd55a5cd2ac890d1ea9b629322c8ed92}


Sends a tcp data train with leading and trailing I\-C\-M\-P messages. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em status} & returns the status/return code \\
\hline
\end{DoxyParams}


Definition at line 626 of file ncd.\-c.

\hypertarget{ncd_8c_a0c8bb5479a27edccf644f75c36f88a03}{\index{ncd.\-c@{ncd.\-c}!send\-\_\-udp@{send\-\_\-udp}}
\index{send\-\_\-udp@{send\-\_\-udp}!ncd.c@{ncd.\-c}}
\subsubsection[{send\-\_\-udp}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ send\-\_\-udp (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{status}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a0c8bb5479a27edccf644f75c36f88a03}


Sends the U\-D\-P data train with leading and trailing I\-C\-M\-P messages. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em status} & returns the status/return code \\
\hline
\end{DoxyParams}


Definition at line 569 of file ncd.\-c.

\hypertarget{ncd_8c_ab684191a099670d8f4f3f4c7ac61c15b}{\index{ncd.\-c@{ncd.\-c}!setup\-\_\-syn\-\_\-packet@{setup\-\_\-syn\-\_\-packet}}
\index{setup\-\_\-syn\-\_\-packet@{setup\-\_\-syn\-\_\-packet}!ncd.c@{ncd.\-c}}
\subsubsection[{setup\-\_\-syn\-\_\-packet}]{\setlength{\rightskip}{0pt plus 5cm}void setup\-\_\-syn\-\_\-packet (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{buff, }
\item[{u\-\_\-int16\-\_\-t}]{port}
\end{DoxyParamCaption}
)}}\label{ncd_8c_ab684191a099670d8f4f3f4c7ac61c15b}


Sets up a single syn packet for use in tcp\-\_\-send. 


\begin{DoxyParams}{Parameters}
{\em buff} & address of tcp header start for syn packet \\
\hline
{\em port} & the source port the syn packet should use. \\
\hline
\end{DoxyParams}


Definition at line 426 of file ncd.\-c.

\hypertarget{ncd_8c_afab7dc6afbfb13289365b893e1d4c741}{\index{ncd.\-c@{ncd.\-c}!setup\-\_\-syn\-\_\-packets@{setup\-\_\-syn\-\_\-packets}}
\index{setup\-\_\-syn\-\_\-packets@{setup\-\_\-syn\-\_\-packets}!ncd.c@{ncd.\-c}}
\subsubsection[{setup\-\_\-syn\-\_\-packets}]{\setlength{\rightskip}{0pt plus 5cm}void setup\-\_\-syn\-\_\-packets (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_afab7dc6afbfb13289365b893e1d4c741}


Sets up syn packets for use in tcp\-\_\-send. 



Definition at line 455 of file ncd.\-c.

\hypertarget{ncd_8c_a95d03bf539922f9b644641a45bd7c836}{\index{ncd.\-c@{ncd.\-c}!setup\-\_\-tcp\-\_\-packets@{setup\-\_\-tcp\-\_\-packets}}
\index{setup\-\_\-tcp\-\_\-packets@{setup\-\_\-tcp\-\_\-packets}!ncd.c@{ncd.\-c}}
\subsubsection[{setup\-\_\-tcp\-\_\-packets}]{\setlength{\rightskip}{0pt plus 5cm}int setup\-\_\-tcp\-\_\-packets (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a95d03bf539922f9b644641a45bd7c836}


sets up arrays of T\-C\-P packets. 

Can be extended to U\-D\-P if necessary \begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 526 of file ncd.\-c.

\hypertarget{ncd_8c_a9ce97d161cdf0a5c7fe5900400b08897}{\index{ncd.\-c@{ncd.\-c}!setup\-\_\-tcp\-\_\-train@{setup\-\_\-tcp\-\_\-train}}
\index{setup\-\_\-tcp\-\_\-train@{setup\-\_\-tcp\-\_\-train}!ncd.c@{ncd.\-c}}
\subsubsection[{setup\-\_\-tcp\-\_\-train}]{\setlength{\rightskip}{0pt plus 5cm}int setup\-\_\-tcp\-\_\-train (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{buff, }
\item[{int}]{fill}
\end{DoxyParamCaption}
)}}\label{ncd_8c_a9ce97d161cdf0a5c7fe5900400b08897}


sets up an array of T\-C\-P packets located at buff. 

Can be extended to U\-D\-P if necessary 
\begin{DoxyParams}{Parameters}
{\em buff} & the starting location of the packet train \\
\hline
{\em fill} & a boolean value to fill the packets from file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns an integer value for success(0), failure(1), or error(-\/1) 
\end{DoxyReturn}


Definition at line 461 of file ncd.\-c.



\subsection{Variable Documentation}
\hypertarget{ncd_8c_af6120b55f42d5cb6044788bba68b9521}{\index{ncd.\-c@{ncd.\-c}!cooldown@{cooldown}}
\index{cooldown@{cooldown}!ncd.c@{ncd.\-c}}
\subsubsection[{cooldown}]{\setlength{\rightskip}{0pt plus 5cm}int cooldown = 5}}\label{ncd_8c_af6120b55f42d5cb6044788bba68b9521}


Definition at line 19 of file ncd.\-c.

\hypertarget{ncd_8c_aa41cf2785d688ec1e35c38a45f66c3bf}{\index{ncd.\-c@{ncd.\-c}!destip@{destip}}
\index{destip@{destip}!ncd.c@{ncd.\-c}}
\subsubsection[{destip}]{\setlength{\rightskip}{0pt plus 5cm}struct in\-\_\-addr destip = \{0\}}}\label{ncd_8c_aa41cf2785d688ec1e35c38a45f66c3bf}


Definition at line 33 of file ncd.\-c.

\hypertarget{ncd_8c_aa600d86ba40a79af175750031d366976}{\index{ncd.\-c@{ncd.\-c}!dst\-\_\-ip@{dst\-\_\-ip}}
\index{dst\-\_\-ip@{dst\-\_\-ip}!ncd.c@{ncd.\-c}}
\subsubsection[{dst\-\_\-ip}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ dst\-\_\-ip = N\-U\-L\-L}}\label{ncd_8c_aa600d86ba40a79af175750031d366976}


Definition at line 11 of file ncd.\-c.

\hypertarget{ncd_8c_adf16cd437526a5c5e0e0af87745acbb8}{\index{ncd.\-c@{ncd.\-c}!file@{file}}
\index{file@{file}!ncd.c@{ncd.\-c}}
\subsubsection[{file}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ file = N\-U\-L\-L}}\label{ncd_8c_adf16cd437526a5c5e0e0af87745acbb8}


Definition at line 12 of file ncd.\-c.

\hypertarget{ncd_8c_a2d25ad4faac817d870daa9b3b680e31d}{\index{ncd.\-c@{ncd.\-c}!hflag@{hflag}}
\index{hflag@{hflag}!ncd.c@{ncd.\-c}}
\subsubsection[{hflag}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int8\-\_\-t hflag = 1}}\label{ncd_8c_a2d25ad4faac817d870daa9b3b680e31d}


Definition at line 16 of file ncd.\-c.

\hypertarget{ncd_8c_a806e49f97606bb7dbd7046b2fe7f0f3a}{\index{ncd.\-c@{ncd.\-c}!icmp\-\_\-send@{icmp\-\_\-send}}
\index{icmp\-\_\-send@{icmp\-\_\-send}!ncd.c@{ncd.\-c}}
\subsubsection[{icmp\-\_\-send}]{\setlength{\rightskip}{0pt plus 5cm}char icmp\-\_\-send\mbox{[}128\mbox{]} = \{0\}}}\label{ncd_8c_a806e49f97606bb7dbd7046b2fe7f0f3a}


Definition at line 28 of file ncd.\-c.

\hypertarget{ncd_8c_a0373c2ec9cc3ad13431fb273d8c3e1db}{\index{ncd.\-c@{ncd.\-c}!lflag@{lflag}}
\index{lflag@{lflag}!ncd.c@{ncd.\-c}}
\subsubsection[{lflag}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int8\-\_\-t lflag = 1}}\label{ncd_8c_a0373c2ec9cc3ad13431fb273d8c3e1db}


Definition at line 15 of file ncd.\-c.

\hypertarget{ncd_8c_ac2d0ab5e69029d08b446d94e9400f3a7}{\index{ncd.\-c@{ncd.\-c}!num\-\_\-threads@{num\-\_\-threads}}
\index{num\-\_\-threads@{num\-\_\-threads}!ncd.c@{ncd.\-c}}
\subsubsection[{num\-\_\-threads}]{\setlength{\rightskip}{0pt plus 5cm}const int num\-\_\-threads = 2}}\label{ncd_8c_ac2d0ab5e69029d08b446d94e9400f3a7}


Definition at line 18 of file ncd.\-c.

\hypertarget{ncd_8c_a2c35aa99e2fa1178b69dedba73b0080c}{\index{ncd.\-c@{ncd.\-c}!packet\-\_\-id@{packet\-\_\-id}}
\index{packet\-\_\-id@{packet\-\_\-id}!ncd.c@{ncd.\-c}}
\subsubsection[{packet\-\_\-id}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int16\-\_\-t$\ast$ packet\-\_\-id = (u\-\_\-int16\-\_\-t$\ast$){\bf packet\-\_\-send}}}\label{ncd_8c_a2c35aa99e2fa1178b69dedba73b0080c}


Definition at line 31 of file ncd.\-c.

\hypertarget{ncd_8c_a94439982e7fc188dc12311c47568f5f9}{\index{ncd.\-c@{ncd.\-c}!packet\-\_\-rcv@{packet\-\_\-rcv}}
\index{packet\-\_\-rcv@{packet\-\_\-rcv}!ncd.c@{ncd.\-c}}
\subsubsection[{packet\-\_\-rcv}]{\setlength{\rightskip}{0pt plus 5cm}char packet\-\_\-rcv\mbox{[}1500\mbox{]} = \{0\}}}\label{ncd_8c_a94439982e7fc188dc12311c47568f5f9}


Definition at line 24 of file ncd.\-c.

\hypertarget{ncd_8c_a43587531405dea543232fa917b84de56}{\index{ncd.\-c@{ncd.\-c}!packet\-\_\-send@{packet\-\_\-send}}
\index{packet\-\_\-send@{packet\-\_\-send}!ncd.c@{ncd.\-c}}
\subsubsection[{packet\-\_\-send}]{\setlength{\rightskip}{0pt plus 5cm}char packet\-\_\-send\mbox{[}{\bf S\-I\-Z\-E}\mbox{]} = \{0\}}}\label{ncd_8c_a43587531405dea543232fa917b84de56}


Definition at line 25 of file ncd.\-c.

\hypertarget{ncd_8c_ae1231b405862fa498bb62b2d7ac40638}{\index{ncd.\-c@{ncd.\-c}!packets\-\_\-e@{packets\-\_\-e}}
\index{packets\-\_\-e@{packets\-\_\-e}!ncd.c@{ncd.\-c}}
\subsubsection[{packets\-\_\-e}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ packets\-\_\-e = N\-U\-L\-L}}\label{ncd_8c_ae1231b405862fa498bb62b2d7ac40638}


Definition at line 9 of file ncd.\-c.

\hypertarget{ncd_8c_a992ffe562a51dd08098b04a399a932ff}{\index{ncd.\-c@{ncd.\-c}!packets\-\_\-f@{packets\-\_\-f}}
\index{packets\-\_\-f@{packets\-\_\-f}!ncd.c@{ncd.\-c}}
\subsubsection[{packets\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ packets\-\_\-f = N\-U\-L\-L}}\label{ncd_8c_a992ffe562a51dd08098b04a399a932ff}


Definition at line 10 of file ncd.\-c.

\hypertarget{ncd_8c_a3d02a4ce56562a5dd244b87d52d694d4}{\index{ncd.\-c@{ncd.\-c}!ps@{ps}}
\index{ps@{ps}!ncd.c@{ncd.\-c}}
\subsubsection[{ps}]{\setlength{\rightskip}{0pt plus 5cm}struct pseudo\-\_\-header$\ast$ ps = (struct pseudo\-\_\-header$\ast$){\bf pseudo}}}\label{ncd_8c_a3d02a4ce56562a5dd244b87d52d694d4}


Definition at line 30 of file ncd.\-c.

\hypertarget{ncd_8c_ab47c0369a44e17ff814fca2f5a7803d1}{\index{ncd.\-c@{ncd.\-c}!pseudo@{pseudo}}
\index{pseudo@{pseudo}!ncd.c@{ncd.\-c}}
\subsubsection[{pseudo}]{\setlength{\rightskip}{0pt plus 5cm}char pseudo\mbox{[}1500\mbox{]} = \{0\}}}\label{ncd_8c_ab47c0369a44e17ff814fca2f5a7803d1}


Definition at line 23 of file ncd.\-c.

\hypertarget{ncd_8c_a6e7246feab9bd6f3f5da6f698465c62a}{\index{ncd.\-c@{ncd.\-c}!recv\-\_\-data@{recv\-\_\-data}}
\index{recv\-\_\-data@{recv\-\_\-data}!ncd.c@{ncd.\-c}}
\subsubsection[{recv\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$($\ast$ recv\-\_\-data)(void $\ast$) = N\-U\-L\-L}}\label{ncd_8c_a6e7246feab9bd6f3f5da6f698465c62a}


Definition at line 37 of file ncd.\-c.

\hypertarget{ncd_8c_a8df42e4f21cb586ea4981025137520e0}{\index{ncd.\-c@{ncd.\-c}!res@{res}}
\index{res@{res}!ncd.c@{ncd.\-c}}
\subsubsection[{res}]{\setlength{\rightskip}{0pt plus 5cm}struct addrinfo$\ast$ res = N\-U\-L\-L}}\label{ncd_8c_a8df42e4f21cb586ea4981025137520e0}


Definition at line 36 of file ncd.\-c.

\hypertarget{ncd_8c_a7f3b94a4048f6fd566062cb98a2e4143}{\index{ncd.\-c@{ncd.\-c}!sa\-\_\-len@{sa\-\_\-len}}
\index{sa\-\_\-len@{sa\-\_\-len}!ncd.c@{ncd.\-c}}
\subsubsection[{sa\-\_\-len}]{\setlength{\rightskip}{0pt plus 5cm}socklen\-\_\-t sa\-\_\-len = sizeof({\bf srcaddrs})}}\label{ncd_8c_a7f3b94a4048f6fd566062cb98a2e4143}


Definition at line 34 of file ncd.\-c.

\hypertarget{ncd_8c_a69b40191667f8e98fe175046c8121df4}{\index{ncd.\-c@{ncd.\-c}!second\-\_\-train@{second\-\_\-train}}
\index{second\-\_\-train@{second\-\_\-train}!ncd.c@{ncd.\-c}}
\subsubsection[{second\-\_\-train}]{\setlength{\rightskip}{0pt plus 5cm}int second\-\_\-train = 0}}\label{ncd_8c_a69b40191667f8e98fe175046c8121df4}


Definition at line 21 of file ncd.\-c.

\hypertarget{ncd_8c_a915720bd1608e183b14479e206ecea46}{\index{ncd.\-c@{ncd.\-c}!send\-\_\-train@{send\-\_\-train}}
\index{send\-\_\-train@{send\-\_\-train}!ncd.c@{ncd.\-c}}
\subsubsection[{send\-\_\-train}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$($\ast$ send\-\_\-train)(void $\ast$) = N\-U\-L\-L}}\label{ncd_8c_a915720bd1608e183b14479e206ecea46}


Definition at line 38 of file ncd.\-c.

\hypertarget{ncd_8c_a48e92478efee9e56a26e4ce75cd47a6e}{\index{ncd.\-c@{ncd.\-c}!srcaddrs@{srcaddrs}}
\index{srcaddrs@{srcaddrs}!ncd.c@{ncd.\-c}}
\subsubsection[{srcaddrs}]{\setlength{\rightskip}{0pt plus 5cm}struct sockaddr\-\_\-in srcaddrs = \{0\}}}\label{ncd_8c_a48e92478efee9e56a26e4ce75cd47a6e}


Definition at line 32 of file ncd.\-c.

\hypertarget{ncd_8c_a20ea96ed21d158a055c5821e81905c45}{\index{ncd.\-c@{ncd.\-c}!syn\-\_\-packet\-\_\-1@{syn\-\_\-packet\-\_\-1}}
\index{syn\-\_\-packet\-\_\-1@{syn\-\_\-packet\-\_\-1}!ncd.c@{ncd.\-c}}
\subsubsection[{syn\-\_\-packet\-\_\-1}]{\setlength{\rightskip}{0pt plus 5cm}char syn\-\_\-packet\-\_\-1\mbox{[}20\mbox{]} = \{0\}}}\label{ncd_8c_a20ea96ed21d158a055c5821e81905c45}


Definition at line 26 of file ncd.\-c.

\hypertarget{ncd_8c_ab685d5eebdfc594a07d1fe0667f7b33c}{\index{ncd.\-c@{ncd.\-c}!syn\-\_\-packet\-\_\-2@{syn\-\_\-packet\-\_\-2}}
\index{syn\-\_\-packet\-\_\-2@{syn\-\_\-packet\-\_\-2}!ncd.c@{ncd.\-c}}
\subsubsection[{syn\-\_\-packet\-\_\-2}]{\setlength{\rightskip}{0pt plus 5cm}char syn\-\_\-packet\-\_\-2\mbox{[}20\mbox{]} = \{0\}}}\label{ncd_8c_ab685d5eebdfc594a07d1fe0667f7b33c}


Definition at line 27 of file ncd.\-c.

\hypertarget{ncd_8c_abba8573cb98a02424a3867f7c43eae3a}{\index{ncd.\-c@{ncd.\-c}!tcp\-\_\-bool@{tcp\-\_\-bool}}
\index{tcp\-\_\-bool@{tcp\-\_\-bool}!ncd.c@{ncd.\-c}}
\subsubsection[{tcp\-\_\-bool}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-int8\-\_\-t tcp\-\_\-bool = 0}}\label{ncd_8c_abba8573cb98a02424a3867f7c43eae3a}


Definition at line 20 of file ncd.\-c.

\hypertarget{ncd_8c_a0b2caeb4b6f130be43e5a2f0267dd453}{\index{ncd.\-c@{ncd.\-c}!verbose@{verbose}}
\index{verbose@{verbose}!ncd.c@{ncd.\-c}}
\subsubsection[{verbose}]{\setlength{\rightskip}{0pt plus 5cm}int verbose = 0}}\label{ncd_8c_a0b2caeb4b6f130be43e5a2f0267dd453}


Definition at line 17 of file ncd.\-c.

